<?php 

$oLista = new Lista('departamento');

$aDepartamento=$oLista->getLista();

unset($oLista);


$limite=0;


$oLista = new Lista('rol');

$aRoles=$oLista->getLista();

unset($oLista);

if($_SESSION["idRol"]==5){
  $oLista = new Lista('usuario_empresa');
  $oLista->setFiltro("idUsuario","=",$_SESSION["idUsuario"]);
  $aEmpresasContador=$oLista->getLista();

  unset($oLista);


  if (count($aEmpresasContador)==2) {
    $limite=1;
  }
}


?>

<form enctype="multipart/form-data" id="frmGuardar">

<section class="section">

        <ul class="breadcrumb breadcrumb-style ">

          <li class="breadcrumb-item">

            <a href="<?php echo $URL; ?>">

              <i class="fas fa-home"></i></a>

          </li>

          <li class="breadcrumb-item">Empresas</li>

          <li class="breadcrumb-item">Crear empresa</li>

        </ul>

        <div class="section-body">

          <div class="row">

            <div class="col-md-12 col-lg-12">

              <div class="card">

                <div class="card-header">

                  <h4>Información General</h4>

                </div>

                <div class="card-body">
                  <?php 
                  if ($limite==1) { ?>
                    <div class="row">
                      <div class="col-md-12">
                        <h3>No puede crear  más empresas, llego al limite permitido</h3>
                      </div>
                    </div>
                  
                  <?php } ?>


                  <?php 
                  if ($limite==0) {
                    // code...
                  
                  ?>

                  <div class="row">

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Tipo persona<span class="requerido">*</span>:</label>

                        <select class="form-control" name="datos[tipoPersona]" id="datos[tipoPersona]" required>

                          <option value="">Seleccione una opción</option>

                          <option value="1">Persona Natural</option>

                          <option value="2">Persona Juridica</option>

                        </select>

                      </div>

                    </div>

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">NIT<span class="requerido">*</span>:</label>

                        <input type="text" class="form-control numero" name="datos[NIT]" id="datos[NIT]" required>

                      </div>

                    </div>

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Digito Verificador<span class="requerido">*</span>:</label>

                        <input type="text" class="form-control numero" maxlength="1" name="datos[digitoVerificador]" id="datos[digitoVerificador]" required>

                      </div>

                    </div>

                  </div>

                  <div class="row">

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Razón Social<span class="requerido">*</span>:</label>

                        <input type="text" class="form-control" name="datos[razonSocial]" id="datos[razonSocial]" required>

                      </div>

                    </div>

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Email<span class="requerido">*</span>:</label>

                        <input type="email" class="form-control" name="datos[correo]" id="datos[correo]" required>

                      </div>

                    </div>

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Telefono<span class="requerido">*</span>:</label>

                        <input type="text" class="form-control numero" name="datos[telefono]" id="datos[telefono]" required>

                      </div>

                    </div>

                  </div>

                  <div class="row">

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Departamento<span class="requerido">*</span>:</label>

                        <select class="form-control" name="datos[idDepartamento]" id="datos[idDepartamento]" required>

                          <option value="">Seleccione una opción</option>

                          <?php foreach($aDepartamento as $item){ ?>

                          <option value='<?php echo $item["idDepartamento"]; ?>'><?php echo $item["nombre"]; ?></option>

                          <?php } ?>

                        </select>

                      </div>

                    </div>

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Ciudad <span class="requerido">*</span>:</label>

                        <select class="form-control" name="datos[idCiudad]" id="datos[idCiudad]" required>

                          <option value="">Seleccione una opción</option>

                          

                        </select>

                      </div>

                    </div>

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Dirección<span class="requerido">*</span>:</label>

                        <input type="text" class="form-control" name="datos[direccion]" id="datos[direccion]" required>

                      </div>

                    </div>

                  </div>

                  <div class="row">

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Logo<span class="requerido">*</span>:</label>

                        <div class="custom-file">

                          <input type="file" class="custom-file-input" id="logo" name="logo" required accept="image/*">

                          <label class="custom-file-label" for="customFile">Seleccionar archivo</label>

                        </div>

                      </div>

                    </div>

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Camara Comercio<span class="requerido">*</span>:</label>

                        <div class="custom-file">

                          <input type="file" class="custom-file-input" id="camaraComercio" name="camaraComercio" required>

                          <label class="custom-file-label" for="customFile">Seleccionar archivo</label>

                        </div>

                      </div>

                    </div>

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">RUT<span class="requerido">*</span>:</label>

                        <div class="custom-file">

                          <input type="file" class="custom-file-input" id="rut" name="rut" required>

                          <label class="custom-file-label" for="customFile">Seleccionar archivo</label>

                        </div>

                      </div>

                    </div>

                  </div>

                  </div>

                  <div class="card-header">

                    <h4>Representante Legal</h4>

                  </div>

                  <div class="card-body">

                    <div class="row">

                      <div class="col-md-3">

                        <div class="form-group">

                          <label class="negrita">Tipo Documento<span class="requerido">*</span>:</label>

                          <select class="form-control" name="representante[tipoDocumento]" id="representante[tipoDocumento]" required>

                            <option value="">Seleccione una opción</option>

                            <option value="1">Cédula Ciudadanía</option>

                            <option value="2">Pasaporte</option>

                          </select>

                        </div>

                      </div>

                      <div class="col-md-3">

                        <div class="form-group">

                          <label class="negrita">N° Documento<span class="requerido">*</span>:</label>

                          <input type="text" class="form-control numero" name="representante[numeroDocumento]" id="representante[numeroDocumento]" required>

                        </div>

                      </div>

                      <div class="col-md-3">

                        <div class="form-group">

                          <label class="negrita">Nombres<span class="requerido">*</span>:</label>

                          <input type="text" class="form-control" name="representante[nombres]" id="representante[nombres]" required>

                        </div>

                      </div>

                      <div class="col-md-3">

                        <div class="form-group">

                          <label class="negrita">Apellidos<span class="requerido">*</span>:</label>

                          <input type="text" class="form-control" name="representante[apellidos]" id="representante[apellidos]" required>

                        </div>

                      </div>

                  </div>

                  <div class="row">

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Email<span class="requerido">*</span>:</label>

                        <input type="email" class="form-control" name="representante[correo]" id="representante[correo]" required>

                      </div>

                    </div>

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Telefono<span class="requerido">*</span>:</label>

                        <input type="text" class="form-control numero" name="representante[telefono]" id="representante[telefono]" required>

                      </div>

                    </div>

                    <div class="col-md-4">

                      <div class="form-group">

                        <label class="negrita">Cedula Representante Legal<span class="requerido">*</span>:</label>

                        <div class="custom-file">

                          <input type="file" class="custom-file-input" id="cedula" name="cedula" required>

                          <label class="custom-file-label" for="customFile">Seleccionar archivo</label>

                        </div>

                      </div>

                    </div>

                  </div>
                  <?php if ($_SESSION['idRol']!=5) {
                    
                  ?>
                  <div class="row">
                    <label>¿Desea registrar la empresa adicionalmente como cliente o proveedor de otras empresas?</label>
                  </div>
                  <div class="row">
                    <div class="col-md-2">
                      <div class="form-group">
                              <input  type="checkbox" name="datos[checkCliente]" id="datos[checkCliente" value="1">
                              <label class="form-check-label" for="defaultCheck1">CLIENTE</label>
                            </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                              <input class="form-check-input menu" type="checkbox" name="datos[checkProveedor]" id="datos[checkProveedor]" value="1">
                              <label class="form-check-label" for="defaultCheck1">PROVEEDOR</label>
                            </div>
                    </div>
                  </div>
                <?php 
              }
              } ?>
                </div>
                
               <?php if ($limite==0) { ?>
                  <div class="card-footer text-right">

                    <a class="btn btn-primary mr-1" id="btnGuardar">Guardar</a>

                  </div>
                 <?php } ?>

                </div>

            </div>

        </div>

    </div>

</section>

</form>

